"use strict";var age=(()=>{var Jt=Object.defineProperty;var Yn=Object.getOwnPropertyDescriptor;var Zn=Object.getOwnPropertyNames;var Qn=Object.prototype.hasOwnProperty;var te=(e,t)=>{for(var n in t)Jt(e,n,{get:t[n],enumerable:!0})},Jn=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Zn(t))!Qn.call(e,s)&&s!==n&&Jt(e,s,{get:()=>t[s],enumerable:!(r=Yn(t,s))||r.enumerable});return e};var tr=e=>Jn(Jt({},"__esModule",{value:!0}),e);var ro={};te(ro,{Decrypter:()=>Ge,Encrypter:()=>je,Stanza:()=>Q,armor:()=>qe,generateIdentity:()=>kn,identityToRecipient:()=>Mn,webauthn:()=>Ve});function z(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function er(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Ut(e,...t){if(!er(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function at(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");z(e.outputLen),z(e.blockLen)}function xt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function $e(e,t){Ut(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}var ut=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function It(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function bt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function X(e,t){return e<<32-t|e>>>t}function k(e,t){return e<<t|e>>>32-t>>>0}var ee=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function nr(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function ne(e){for(let t=0;t<e.length;t++)e[t]=nr(e[t])}function We(e){if(typeof e!="string")throw new Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}function Y(e){return typeof e=="string"&&(e=We(e)),Ut(e),e}var wt=class{clone(){return this._cloneInto()}};function St(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function Xe(e){let t=r=>e().update(Y(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}function j(e=32){if(ut&&typeof ut.getRandomValues=="function")return ut.getRandomValues(new Uint8Array(e));if(ut&&typeof ut.randomBytes=="function")return ut.randomBytes(e);throw new Error("crypto.getRandomValues must be defined")}var Ct=class extends wt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,at(t);let r=Y(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return xt(this),this.iHash.update(t),this}digestInto(t){xt(this),Ut(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));let{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:i,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},et=(e,t,n)=>new Ct(e,t).update(n).digest();et.create=(e,t)=>new Ct(e,t);function oe(e,t,n){return at(e),n===void 0&&(n=new Uint8Array(e.outputLen)),et(e,Y(n),Y(t))}var re=new Uint8Array([0]),Ye=new Uint8Array;function rr(e,t,n,r=32){if(at(e),z(r),r>255*e.outputLen)throw new Error("Length should be <= 255*HashLen");let s=Math.ceil(r/e.outputLen);n===void 0&&(n=Ye);let o=new Uint8Array(s*e.outputLen),i=et.create(e,t),c=i._cloneInto(),f=new Uint8Array(i.outputLen);for(let u=0;u<s;u++)re[0]=u+1,c.update(u===0?Ye:f).update(n).update(re).digestInto(f),o.set(f,e.outputLen*u),i._cloneInto(c);return i.destroy(),c.destroy(),f.fill(0),re.fill(0),o.slice(0,r)}var st=(e,t,n,r,s)=>rr(e,oe(e,t,n),r,s);function or(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),f=r?4:0,u=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+u,c,r)}function Ze(e,t,n){return e&t^~e&n}function Qe(e,t,n){return e&t^e&n^t&n}var Tt=class extends wt{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=bt(this.buffer)}update(t){xt(this);let{view:n,buffer:r,blockLen:s}=this;t=Y(t);let o=t.length;for(let i=0;i<o;){let c=Math.min(s-this.pos,o-i);if(c===s){let f=bt(t);for(;s<=o-i;i+=s)this.process(f,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){xt(this),$e(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:s,isLE:o}=this,{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let a=i;a<s;a++)n[a]=0;or(r,s-8,BigInt(this.length*8),o),this.process(r,0);let c=bt(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=f/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let a=0;a<u;a++)c.setUint32(4*a,l[a],o)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:c}=this;return t.length=s,t.pos=c,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}};var sr=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),it=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),ct=new Uint32Array(64),se=class extends Tt{constructor(){super(64,32,8,!1),this.A=it[0]|0,this.B=it[1]|0,this.C=it[2]|0,this.D=it[3]|0,this.E=it[4]|0,this.F=it[5]|0,this.G=it[6]|0,this.H=it[7]|0}get(){let{A:t,B:n,C:r,D:s,E:o,F:i,G:c,H:f}=this;return[t,n,r,s,o,i,c,f]}set(t,n,r,s,o,i,c,f){this.A=t|0,this.B=n|0,this.C=r|0,this.D=s|0,this.E=o|0,this.F=i|0,this.G=c|0,this.H=f|0}process(t,n){for(let a=0;a<16;a++,n+=4)ct[a]=t.getUint32(n,!1);for(let a=16;a<64;a++){let d=ct[a-15],p=ct[a-2],y=X(d,7)^X(d,18)^d>>>3,h=X(p,17)^X(p,19)^p>>>10;ct[a]=h+ct[a-7]+y+ct[a-16]|0}let{A:r,B:s,C:o,D:i,E:c,F:f,G:u,H:l}=this;for(let a=0;a<64;a++){let d=X(c,6)^X(c,11)^X(c,25),p=l+d+Ze(c,f,u)+sr[a]+ct[a]|0,h=(X(r,2)^X(r,13)^X(r,22))+Qe(r,s,o)|0;l=u,u=f,f=c,c=i+p|0,i=o,o=s,s=r,r=p+h|0}r=r+this.A|0,s=s+this.B|0,o=o+this.C|0,i=i+this.D|0,c=c+this.E|0,f=f+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(r,s,o,i,c,f,u,l)}roundClean(){ct.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var V=Xe(()=>new se);function nn(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function rn(e,t){return Array.isArray(t)?t.length===0?!0:e?t.every(n=>typeof n=="string"):t.every(n=>Number.isSafeInteger(n)):!1}function ir(e){if(typeof e!="function")throw new Error("function expected");return!0}function mt(e,t){if(typeof t!="string")throw new Error(`${e}: string expected`);return!0}function ae(e){if(!Number.isSafeInteger(e))throw new Error(`invalid integer: ${e}`)}function ie(e){if(!Array.isArray(e))throw new Error("array expected")}function Rt(e,t){if(!rn(!0,t))throw new Error(`${e}: array of strings expected`)}function on(e,t){if(!rn(!1,t))throw new Error(`${e}: array of numbers expected`)}function ue(...e){let t=o=>o,n=(o,i)=>c=>o(i(c)),r=e.map(o=>o.encode).reduceRight(n,t),s=e.map(o=>o.decode).reduce(n,t);return{encode:r,decode:s}}function le(e){let t=typeof e=="string"?e.split(""):e,n=t.length;Rt("alphabet",t);let r=new Map(t.map((s,o)=>[s,o]));return{encode:s=>(ie(s),s.map(o=>{if(!Number.isSafeInteger(o)||o<0||o>=n)throw new Error(`alphabet.encode: digit index outside alphabet "${o}". Allowed: ${e}`);return t[o]})),decode:s=>(ie(s),s.map(o=>{mt("alphabet.decode",o);let i=r.get(o);if(i===void 0)throw new Error(`Unknown letter: "${o}". Allowed: ${e}`);return i}))}}function de(e=""){return mt("join",e),{encode:t=>(Rt("join.decode",t),t.join(e)),decode:t=>(mt("join.decode",t),t.split(e))}}function cr(e,t="="){return ae(e),mt("padding",t),{encode(n){for(Rt("padding.encode",n);n.length*e%8;)n.push(t);return n},decode(n){Rt("padding.decode",n);let r=n.length;if(r*e%8)throw new Error("padding: invalid, string should have whole number of bytes");for(;r>0&&n[r-1]===t;r--)if((r-1)*e%8===0)throw new Error("padding: invalid, string has too much padding");return n.slice(0,r)}}}var sn=(e,t)=>t===0?e:sn(t,e%t),Nt=(e,t)=>e+(t-sn(e,t)),_t=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function ce(e,t,n,r){if(ie(e),t<=0||t>32)throw new Error(`convertRadix2: wrong from=${t}`);if(n<=0||n>32)throw new Error(`convertRadix2: wrong to=${n}`);if(Nt(t,n)>32)throw new Error(`convertRadix2: carry overflow from=${t} to=${n} carryBits=${Nt(t,n)}`);let s=0,o=0,i=_t[t],c=_t[n]-1,f=[];for(let u of e){if(ae(u),u>=i)throw new Error(`convertRadix2: invalid data word=${u} from=${t}`);if(s=s<<t|u,o+t>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${t}`);for(o+=t;o>=n;o-=n)f.push((s>>o-n&c)>>>0);let l=_t[o];if(l===void 0)throw new Error("invalid carry");s&=l-1}if(s=s<<n-o&c,!r&&o>=t)throw new Error("Excess padding");if(!r&&s>0)throw new Error(`Non-zero padding: ${s}`);return r&&o>0&&f.push(s>>>0),f}function he(e,t=!1){if(ae(e),e<=0||e>32)throw new Error("radix2: bits should be in (0..32]");if(Nt(8,e)>32||Nt(e,8)>32)throw new Error("radix2: carry overflow");return{encode:n=>{if(!nn(n))throw new Error("radix2.encode input should be Uint8Array");return ce(Array.from(n),8,e,!t)},decode:n=>(on("radix2.decode",n),Uint8Array.from(ce(n,e,8,t)))}}function Je(e){return ir(e),function(...t){try{return e.apply(null,t)}catch{}}}var pe=ue(he(6),le("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),cr(6),de("")),G=ue(he(6),le("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),de(""));var fe=ue(le("qpzry9x8gf2tvdw0s3jn54khce6mua7l"),de("")),tn=[996825010,642813549,513874426,1027748829,705979059];function Lt(e){let t=e>>25,n=(e&33554431)<<5;for(let r=0;r<tn.length;r++)(t>>r&1)===1&&(n^=tn[r]);return n}function en(e,t,n=1){let r=e.length,s=1;for(let o=0;o<r;o++){let i=e.charCodeAt(o);if(i<33||i>126)throw new Error(`Invalid prefix (${e})`);s=Lt(s)^i>>5}s=Lt(s);for(let o=0;o<r;o++)s=Lt(s)^e.charCodeAt(o)&31;for(let o of t)s=Lt(s)^o;for(let o=0;o<6;o++)s=Lt(s);return s^=n,fe.encode(ce([s%_t[30]],30,5,!1))}function fr(e){let t=e==="bech32"?1:734539939,n=he(5),r=n.decode,s=n.encode,o=Je(r);function i(a,d,p=90){mt("bech32.encode prefix",a),nn(d)&&(d=Array.from(d)),on("bech32.encode",d);let y=a.length;if(y===0)throw new TypeError(`Invalid prefix length ${y}`);let h=y+7+d.length;if(p!==!1&&h>p)throw new TypeError(`Length ${h} exceeds limit ${p}`);let w=a.toLowerCase(),m=en(w,d,t);return`${w}1${fe.encode(d)}${m}`}function c(a,d=90){mt("bech32.decode input",a);let p=a.length;if(p<8||d!==!1&&p>d)throw new TypeError(`invalid string length: ${p} (${a}). Expected (8..${d})`);let y=a.toLowerCase();if(a!==y&&a!==a.toUpperCase())throw new Error("String must be lowercase or uppercase");let h=y.lastIndexOf("1");if(h===0||h===-1)throw new Error('Letter "1" must be present between prefix and data only');let w=y.slice(0,h),m=y.slice(h+1);if(m.length<6)throw new Error("Data must be at least 6 characters long");let b=fe.decode(m).slice(0,-6),E=en(w,b,t);if(!m.endsWith(E))throw new Error(`Invalid checksum in ${a}: expected "${E}"`);return{prefix:w,words:b}}let f=Je(c);function u(a){let{prefix:d,words:p}=c(a,!1);return{prefix:d,words:p,bytes:r(p)}}function l(a,d){return i(a,s(d))}return{encode:i,decode:c,encodeFromBytes:l,decodeToBytes:u,decodeUnsafe:f,fromWords:r,fromWordsUnsafe:o,toWords:s}}var Z=fr("bech32");function ur(e,t,n,r){at(e);let s=St({dkLen:32,asyncTick:10},r),{c:o,dkLen:i,asyncTick:c}=s;if(z(o),z(i),z(c),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let f=Y(t),u=Y(n),l=new Uint8Array(i),a=et.create(e,f),d=a._cloneInto().update(u);return{c:o,dkLen:i,asyncTick:c,DK:l,PRF:a,PRFSalt:d}}function lr(e,t,n,r,s){return e.destroy(),t.destroy(),r&&r.destroy(),s.fill(0),n}function ye(e,t,n,r){let{c:s,dkLen:o,DK:i,PRF:c,PRFSalt:f}=ur(e,t,n,r),u,l=new Uint8Array(4),a=bt(l),d=new Uint8Array(c.outputLen);for(let p=1,y=0;y<o;p++,y+=c.outputLen){let h=i.subarray(y,y+c.outputLen);a.setInt32(0,p,!1),(u=f._cloneInto(u)).update(l).digestInto(d),h.set(d.subarray(0,h.length));for(let w=1;w<s;w++){c._cloneInto(u).update(d).digestInto(d);for(let m=0;m<h.length;m++)h[m]^=d[m]}}return lr(c,f,i,u,d)}function cn(e,t,n,r,s,o){let i=e[t++]^n[r++],c=e[t++]^n[r++],f=e[t++]^n[r++],u=e[t++]^n[r++],l=e[t++]^n[r++],a=e[t++]^n[r++],d=e[t++]^n[r++],p=e[t++]^n[r++],y=e[t++]^n[r++],h=e[t++]^n[r++],w=e[t++]^n[r++],m=e[t++]^n[r++],b=e[t++]^n[r++],E=e[t++]^n[r++],T=e[t++]^n[r++],P=e[t++]^n[r++],L=i,O=c,M=f,A=u,U=l,B=a,N=d,v=p,_=y,I=h,S=w,C=m,R=b,x=E,H=T,K=P;for(let q=0;q<8;q+=2)U^=k(L+R|0,7),_^=k(U+L|0,9),R^=k(_+U|0,13),L^=k(R+_|0,18),I^=k(B+O|0,7),x^=k(I+B|0,9),O^=k(x+I|0,13),B^=k(O+x|0,18),H^=k(S+N|0,7),M^=k(H+S|0,9),N^=k(M+H|0,13),S^=k(N+M|0,18),A^=k(K+C|0,7),v^=k(A+K|0,9),C^=k(v+A|0,13),K^=k(C+v|0,18),O^=k(L+A|0,7),M^=k(O+L|0,9),A^=k(M+O|0,13),L^=k(A+M|0,18),N^=k(B+U|0,7),v^=k(N+B|0,9),U^=k(v+N|0,13),B^=k(U+v|0,18),C^=k(S+I|0,7),_^=k(C+S|0,9),I^=k(_+C|0,13),S^=k(I+_|0,18),R^=k(K+H|0,7),x^=k(R+K|0,9),H^=k(x+R|0,13),K^=k(H+x|0,18);s[o++]=i+L|0,s[o++]=c+O|0,s[o++]=f+M|0,s[o++]=u+A|0,s[o++]=l+U|0,s[o++]=a+B|0,s[o++]=d+N|0,s[o++]=p+v|0,s[o++]=y+_|0,s[o++]=h+I|0,s[o++]=w+S|0,s[o++]=m+C|0,s[o++]=b+R|0,s[o++]=E+x|0,s[o++]=T+H|0,s[o++]=P+K|0}function ge(e,t,n,r,s){let o=r+0,i=r+16*s;for(let c=0;c<16;c++)n[i+c]=e[t+(2*s-1)*16+c];for(let c=0;c<s;c++,o+=16,t+=16)cn(n,i,e,t,n,o),c>0&&(i+=16),cn(n,o,e,t+=16,n,i)}function dr(e,t,n){let r=St({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:s,r:o,p:i,dkLen:c,asyncTick:f,maxmem:u,onProgress:l}=r;if(z(s),z(o),z(i),z(c),z(f),z(u),l!==void 0&&typeof l!="function")throw new Error("progressCb should be function");let a=128*o,d=a/4;if(s<=1||s&s-1||s>2**32)throw new Error("Scrypt: N must be larger than 1, a power of 2, and less than 2^32");if(i<0||i>(2**32-1)*32/a)throw new Error("Scrypt: p must be a positive integer less than or equal to ((2^32 - 1) * 32) / (128 * r)");if(c<0||c>(2**32-1)*32)throw new Error("Scrypt: dkLen should be positive integer less than or equal to (2^32 - 1) * 32");if(a*(s+i)>u)throw new Error("Scrypt: memused is bigger than maxMem. Expected 128 * r * (N + p) > maxmem of "+u);let y=ye(V,e,t,{c:1,dkLen:a*i}),h=It(y),w=It(new Uint8Array(a*s)),m=It(new Uint8Array(a)),b=()=>{};if(l){let E=2*s*i,T=Math.max(Math.floor(E/1e4),1),P=0;b=()=>{P++,l&&(!(P%T)||P===E)&&l(P/E)}}return{N:s,r:o,p:i,dkLen:c,blockSize32:d,V:w,B32:h,B:y,tmp:m,blockMixCb:b,asyncTick:f}}function hr(e,t,n,r,s){let o=ye(V,e,n,{c:1,dkLen:t});return n.fill(0),r.fill(0),s.fill(0),o}function xe(e,t,n){let{N:r,r:s,p:o,dkLen:i,blockSize32:c,V:f,B32:u,B:l,tmp:a,blockMixCb:d}=dr(e,t,n);ee||ne(u);for(let p=0;p<o;p++){let y=c*p;for(let h=0;h<c;h++)f[h]=u[y+h];for(let h=0,w=0;h<r-1;h++)ge(f,w,f,w+=c,s),d();ge(f,(r-1)*c,u,y,s),d();for(let h=0;h<r;h++){let w=u[y+c-16]%r;for(let m=0;m<c;m++)a[m]=u[y+m]^f[w*c+m];ge(a,0,u,y,s),d()}}return ee||ne(u),hr(e,i,l,f,a)}function Ot(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function we(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function D(e,...t){if(!we(e))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw new Error("Uint8Array expected of length "+t+", got length="+e.length)}function be(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function fn(e,t){D(e);let n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function me(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}var nt=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),an=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),pr=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!pr)throw new Error("Non little-endian hardware is not supported");function yr(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function kt(e){if(typeof e=="string")e=yr(e);else if(we(e))e=Mt(e);else throw new Error("Uint8Array expected, got "+typeof e);return e}function un(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function ln(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}var Ee=(e,t)=>{function n(r,...s){if(D(r),e.nonceLength!==void 0){let l=s[0];if(!l)throw new Error("nonce / iv required");e.varSizeNonce?D(l):D(l,e.nonceLength)}let o=e.tagLength;o&&s[1]!==void 0&&D(s[1]);let i=t(r,...s),c=(l,a)=>{if(a!==void 0){if(l!==2)throw new Error("cipher output not supported");D(a)}},f=!1;return{encrypt(l,a){if(f)throw new Error("cannot encrypt() twice with same key + nonce");return f=!0,D(l),c(i.encrypt.length,a),i.encrypt(l,a)},decrypt(l,a){if(D(l),o&&l.length<o)throw new Error("invalid ciphertext length: smaller than tagLength="+o);return c(i.decrypt.length,a),i.decrypt(l,a)}}}return Object.assign(n,e),n};function Be(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error("invalid output length, expected "+e+", got: "+t.length);if(n&&!gr(t))throw new Error("invalid output, must be aligned");return t}function Ae(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);let s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),f=r?4:0,u=r?0:4;e.setUint32(t+f,i,r),e.setUint32(t+u,c,r)}function gr(e){return e.byteOffset%4===0}function Mt(e){return Uint8Array.from(e)}function rt(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}var hn=e=>Uint8Array.from(e.split("").map(t=>t.charCodeAt(0))),xr=hn("expand 16-byte k"),wr=hn("expand 32-byte k"),br=nt(xr),mr=nt(wr);function g(e,t){return e<<t|e>>>32-t}function Ue(e){return e.byteOffset%4===0}var Ht=64,Er=16,pn=2**32-1,dn=new Uint32Array;function Br(e,t,n,r,s,o,i,c){let f=s.length,u=new Uint8Array(Ht),l=nt(u),a=Ue(s)&&Ue(o),d=a?nt(s):dn,p=a?nt(o):dn;for(let y=0;y<f;i++){if(e(t,n,r,l,i,c),i>=pn)throw new Error("arx: counter overflow");let h=Math.min(Ht,f-y);if(a&&h===Ht){let w=y/4;if(y%4!==0)throw new Error("arx: invalid block position");for(let m=0,b;m<Er;m++)b=w+m,p[b]=d[b]^l[m];y+=Ht;continue}for(let w=0,m;w<h;w++)m=y+w,o[m]=s[m]^u[w];y+=h}}function Le(e,t){let{allowShortKeys:n,extendNonceFn:r,counterLength:s,counterRight:o,rounds:i}=un({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Ot(s),Ot(i),me(o),me(n),(c,f,u,l,a=0)=>{D(c),D(f),D(u);let d=u.length;if(l===void 0&&(l=new Uint8Array(d)),D(l),Ot(a),a<0||a>=pn)throw new Error("arx: counter overflow");if(l.length<d)throw new Error(`arx: output (${l.length}) is shorter than data (${d})`);let p=[],y=c.length,h,w;if(y===32)p.push(h=Mt(c)),w=mr;else if(y===16&&n)h=new Uint8Array(32),h.set(c),h.set(c,16),w=br,p.push(h);else throw new Error(`arx: invalid 32-byte key, got length=${y}`);Ue(f)||p.push(f=Mt(f));let m=nt(h);if(r){if(f.length!==24)throw new Error("arx: extended nonce must be 24 bytes");r(w,m,nt(f.subarray(0,16)),m),f=f.subarray(16)}let b=16-s;if(b!==f.length)throw new Error(`arx: nonce must be ${b} or 16 bytes`);if(b!==12){let T=new Uint8Array(12);T.set(f,o?0:12-f.length),f=T,p.push(f)}let E=nt(f);return Br(e,w,m,E,u,l,a,i),rt(...p),l}}var F=(e,t)=>e[t++]&255|(e[t++]&255)<<8,ve=class{constructor(t){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,t=kt(t),D(t,32);let n=F(t,0),r=F(t,2),s=F(t,4),o=F(t,6),i=F(t,8),c=F(t,10),f=F(t,12),u=F(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|r<<3)&8191,this.r[2]=(r>>>10|s<<6)&7939,this.r[3]=(s>>>7|o<<9)&8191,this.r[4]=(o>>>4|i<<12)&255,this.r[5]=i>>>1&8190,this.r[6]=(i>>>14|c<<2)&8191,this.r[7]=(c>>>11|f<<5)&8065,this.r[8]=(f>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=F(t,16+2*l)}process(t,n,r=!1){let s=r?0:2048,{h:o,r:i}=this,c=i[0],f=i[1],u=i[2],l=i[3],a=i[4],d=i[5],p=i[6],y=i[7],h=i[8],w=i[9],m=F(t,n+0),b=F(t,n+2),E=F(t,n+4),T=F(t,n+6),P=F(t,n+8),L=F(t,n+10),O=F(t,n+12),M=F(t,n+14),A=o[0]+(m&8191),U=o[1]+((m>>>13|b<<3)&8191),B=o[2]+((b>>>10|E<<6)&8191),N=o[3]+((E>>>7|T<<9)&8191),v=o[4]+((T>>>4|P<<12)&8191),_=o[5]+(P>>>1&8191),I=o[6]+((P>>>14|L<<2)&8191),S=o[7]+((L>>>11|O<<5)&8191),C=o[8]+((O>>>8|M<<8)&8191),R=o[9]+(M>>>5|s),x=0,H=x+A*c+U*(5*w)+B*(5*h)+N*(5*y)+v*(5*p);x=H>>>13,H&=8191,H+=_*(5*d)+I*(5*a)+S*(5*l)+C*(5*u)+R*(5*f),x+=H>>>13,H&=8191;let K=x+A*f+U*c+B*(5*w)+N*(5*h)+v*(5*y);x=K>>>13,K&=8191,K+=_*(5*p)+I*(5*d)+S*(5*a)+C*(5*l)+R*(5*u),x+=K>>>13,K&=8191;let q=x+A*u+U*f+B*c+N*(5*w)+v*(5*h);x=q>>>13,q&=8191,q+=_*(5*y)+I*(5*p)+S*(5*d)+C*(5*a)+R*(5*l),x+=q>>>13,q&=8191;let $=x+A*l+U*u+B*f+N*c+v*(5*w);x=$>>>13,$&=8191,$+=_*(5*h)+I*(5*y)+S*(5*p)+C*(5*d)+R*(5*a),x+=$>>>13,$&=8191;let J=x+A*a+U*l+B*u+N*f+v*c;x=J>>>13,J&=8191,J+=_*(5*w)+I*(5*h)+S*(5*y)+C*(5*p)+R*(5*d),x+=J>>>13,J&=8191;let tt=x+A*d+U*a+B*l+N*u+v*f;x=tt>>>13,tt&=8191,tt+=_*c+I*(5*w)+S*(5*h)+C*(5*y)+R*(5*p),x+=tt>>>13,tt&=8191;let ht=x+A*p+U*d+B*a+N*l+v*u;x=ht>>>13,ht&=8191,ht+=_*f+I*c+S*(5*w)+C*(5*h)+R*(5*y),x+=ht>>>13,ht&=8191;let pt=x+A*y+U*p+B*d+N*a+v*l;x=pt>>>13,pt&=8191,pt+=_*u+I*f+S*c+C*(5*w)+R*(5*h),x+=pt>>>13,pt&=8191;let yt=x+A*h+U*y+B*p+N*d+v*a;x=yt>>>13,yt&=8191,yt+=_*l+I*u+S*f+C*c+R*(5*w),x+=yt>>>13,yt&=8191;let gt=x+A*w+U*h+B*y+N*p+v*d;x=gt>>>13,gt&=8191,gt+=_*a+I*l+S*u+C*f+R*c,x+=gt>>>13,gt&=8191,x=(x<<2)+x|0,x=x+H|0,H=x&8191,x=x>>>13,K+=x,o[0]=H,o[1]=K,o[2]=q,o[3]=$,o[4]=J,o[5]=tt,o[6]=ht,o[7]=pt,o[8]=yt,o[9]=gt}finalize(){let{h:t,pad:n}=this,r=new Uint16Array(10),s=t[1]>>>13;t[1]&=8191;for(let c=2;c<10;c++)t[c]+=s,s=t[c]>>>13,t[c]&=8191;t[0]+=s*5,s=t[0]>>>13,t[0]&=8191,t[1]+=s,s=t[1]>>>13,t[1]&=8191,t[2]+=s,r[0]=t[0]+5,s=r[0]>>>13,r[0]&=8191;for(let c=1;c<10;c++)r[c]=t[c]+s,s=r[c]>>>13,r[c]&=8191;r[9]-=8192;let o=(s^1)-1;for(let c=0;c<10;c++)r[c]&=o;o=~o;for(let c=0;c<10;c++)t[c]=t[c]&o|r[c];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let i=t[0]+n[0];t[0]=i&65535;for(let c=1;c<8;c++)i=(t[c]+n[c]|0)+(i>>>16)|0,t[c]=i&65535;rt(r)}update(t){be(this);let{buffer:n,blockLen:r}=this;t=kt(t);let s=t.length;for(let o=0;o<s;){let i=Math.min(r-this.pos,s-o);if(i===r){for(;r<=s-o;o+=r)this.process(t,o);continue}n.set(t.subarray(o,o+i),this.pos),this.pos+=i,o+=i,this.pos===r&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){rt(this.h,this.r,this.buffer,this.pad)}digestInto(t){be(this),fn(t,this),this.finished=!0;let{buffer:n,h:r}=this,{pos:s}=this;if(s){for(n[s++]=1;s<16;s++)n[s]=0;this.process(n,0,!0)}this.finalize();let o=0;for(let i=0;i<8;i++)t[o++]=r[i]>>>0,t[o++]=r[i]>>>8;return t}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}};function Ar(e){let t=(r,s)=>e(s).update(kt(r)).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=r=>e(r),t}var yn=Ar(e=>new ve(e));function wn(e,t,n,r,s,o=20){let i=e[0],c=e[1],f=e[2],u=e[3],l=t[0],a=t[1],d=t[2],p=t[3],y=t[4],h=t[5],w=t[6],m=t[7],b=s,E=n[0],T=n[1],P=n[2],L=i,O=c,M=f,A=u,U=l,B=a,N=d,v=p,_=y,I=h,S=w,C=m,R=b,x=E,H=T,K=P;for(let $=0;$<o;$+=2)L=L+U|0,R=g(R^L,16),_=_+R|0,U=g(U^_,12),L=L+U|0,R=g(R^L,8),_=_+R|0,U=g(U^_,7),O=O+B|0,x=g(x^O,16),I=I+x|0,B=g(B^I,12),O=O+B|0,x=g(x^O,8),I=I+x|0,B=g(B^I,7),M=M+N|0,H=g(H^M,16),S=S+H|0,N=g(N^S,12),M=M+N|0,H=g(H^M,8),S=S+H|0,N=g(N^S,7),A=A+v|0,K=g(K^A,16),C=C+K|0,v=g(v^C,12),A=A+v|0,K=g(K^A,8),C=C+K|0,v=g(v^C,7),L=L+B|0,K=g(K^L,16),S=S+K|0,B=g(B^S,12),L=L+B|0,K=g(K^L,8),S=S+K|0,B=g(B^S,7),O=O+N|0,R=g(R^O,16),C=C+R|0,N=g(N^C,12),O=O+N|0,R=g(R^O,8),C=C+R|0,N=g(N^C,7),M=M+v|0,x=g(x^M,16),_=_+x|0,v=g(v^_,12),M=M+v|0,x=g(x^M,8),_=_+x|0,v=g(v^_,7),A=A+U|0,H=g(H^A,16),I=I+H|0,U=g(U^I,12),A=A+U|0,H=g(H^A,8),I=I+H|0,U=g(U^I,7);let q=0;r[q++]=i+L|0,r[q++]=c+O|0,r[q++]=f+M|0,r[q++]=u+A|0,r[q++]=l+U|0,r[q++]=a+B|0,r[q++]=d+N|0,r[q++]=p+v|0,r[q++]=y+_|0,r[q++]=h+I|0,r[q++]=w+S|0,r[q++]=m+C|0,r[q++]=b+R|0,r[q++]=E+x|0,r[q++]=T+H|0,r[q++]=P+K|0}function Ur(e,t,n,r){let s=e[0],o=e[1],i=e[2],c=e[3],f=t[0],u=t[1],l=t[2],a=t[3],d=t[4],p=t[5],y=t[6],h=t[7],w=n[0],m=n[1],b=n[2],E=n[3];for(let P=0;P<20;P+=2)s=s+f|0,w=g(w^s,16),d=d+w|0,f=g(f^d,12),s=s+f|0,w=g(w^s,8),d=d+w|0,f=g(f^d,7),o=o+u|0,m=g(m^o,16),p=p+m|0,u=g(u^p,12),o=o+u|0,m=g(m^o,8),p=p+m|0,u=g(u^p,7),i=i+l|0,b=g(b^i,16),y=y+b|0,l=g(l^y,12),i=i+l|0,b=g(b^i,8),y=y+b|0,l=g(l^y,7),c=c+a|0,E=g(E^c,16),h=h+E|0,a=g(a^h,12),c=c+a|0,E=g(E^c,8),h=h+E|0,a=g(a^h,7),s=s+u|0,E=g(E^s,16),y=y+E|0,u=g(u^y,12),s=s+u|0,E=g(E^s,8),y=y+E|0,u=g(u^y,7),o=o+l|0,w=g(w^o,16),h=h+w|0,l=g(l^h,12),o=o+l|0,w=g(w^o,8),h=h+w|0,l=g(l^h,7),i=i+a|0,m=g(m^i,16),d=d+m|0,a=g(a^d,12),i=i+a|0,m=g(m^i,8),d=d+m|0,a=g(a^d,7),c=c+f|0,b=g(b^c,16),p=p+b|0,f=g(f^p,12),c=c+f|0,b=g(b^c,8),p=p+b|0,f=g(f^p,7);let T=0;r[T++]=s,r[T++]=o,r[T++]=i,r[T++]=c,r[T++]=w,r[T++]=m,r[T++]=b,r[T++]=E}var Lr=Le(wn,{counterRight:!1,counterLength:4,allowShortKeys:!1}),vr=Le(wn,{counterRight:!1,counterLength:8,extendNonceFn:Ur,allowShortKeys:!1});var Ir=new Uint8Array(16),gn=(e,t)=>{e.update(t);let n=t.length%16;n&&e.update(Ir.subarray(n))},Sr=new Uint8Array(32);function xn(e,t,n,r,s){let o=e(t,n,Sr),i=yn.create(o);s&&gn(i,s),gn(i,r);let c=new Uint8Array(16),f=an(c);Ae(f,0,BigInt(s?s.length:0),!0),Ae(f,8,BigInt(r.length),!0),i.update(c);let u=i.digest();return rt(o,c),u}var bn=e=>(t,n,r)=>({encrypt(o,i){let c=o.length;i=Be(c+16,i,!1),i.set(o);let f=i.subarray(0,-16);e(t,n,f,f,1);let u=xn(e,t,n,f,r);return i.set(u,c),rt(u),i},decrypt(o,i){i=Be(o.length-16,i,!1);let c=o.subarray(0,-16),f=o.subarray(-16),u=xn(e,t,n,c,r);if(!ln(f,u))throw new Error("invalid tag");return i.set(o.subarray(0,-16)),e(t,n,i,i,1),rt(u),i}}),ft=Ee({blockSize:64,nonceLength:12,tagLength:16},bn(Lr)),Wo=Ee({blockSize:64,nonceLength:24,tagLength:16},bn(vr));var En=BigInt(0);function Se(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Bn(e){if(!Se(e))throw new Error("Uint8Array expected")}var Cr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Tr(e){Bn(e);let t="";for(let n=0;n<e.length;n++)t+=Cr[e[n]];return t}function _r(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?En:BigInt("0x"+e)}var ot={_0:48,_9:57,A:65,F:70,a:97,f:102};function mn(e){if(e>=ot._0&&e<=ot._9)return e-ot._0;if(e>=ot.A&&e<=ot.F)return e-(ot.A-10);if(e>=ot.a&&e<=ot.f)return e-(ot.a-10)}function An(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let s=0,o=0;s<n;s++,o+=2){let i=mn(e.charCodeAt(o)),c=mn(e.charCodeAt(o+1));if(i===void 0||c===void 0){let f=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+f+'" at index '+o)}r[s]=i*16+c}return r}function Ce(e){return Bn(e),_r(Tr(Uint8Array.from(e).reverse()))}function Rr(e,t){return An(e.toString(16).padStart(t*2,"0"))}function Un(e,t){return Rr(e,t).reverse()}function Te(e,t,n){let r;if(typeof t=="string")try{r=An(t)}catch(o){throw new Error(e+" must be hex string or Uint8Array, cause: "+o)}else if(Se(t))r=Uint8Array.from(t);else throw new Error(e+" must be hex string or Uint8Array");let s=r.length;if(typeof n=="number"&&s!==n)throw new Error(e+" of length "+n+" expected, got "+s);return r}var Ie=e=>typeof e=="bigint"&&En<=e;function Nr(e,t,n){return Ie(e)&&Ie(t)&&Ie(n)&&t<=e&&e<n}function _e(e,t,n,r){if(!Nr(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}var Or={bigint:e=>typeof e=="bigint",function:e=>typeof e=="function",boolean:e=>typeof e=="boolean",string:e=>typeof e=="string",stringOrUint8Array:e=>typeof e=="string"||Se(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>typeof e=="function"&&Number.isSafeInteger(e.outputLen)};function Ln(e,t,n={}){let r=(s,o,i)=>{let c=Or[o];if(typeof c!="function")throw new Error("invalid validator function");let f=e[s];if(!(i&&f===void 0)&&!c(f,e))throw new Error("param "+String(s)+" is invalid. Expected "+o+", got "+f)};for(let[s,o]of Object.entries(t))r(s,o,!1);for(let[s,o]of Object.entries(n))r(s,o,!0);return e}var Et=BigInt(0),Kt=BigInt(1);function qt(e,t){let n=e%t;return n>=Et?n:t+n}function vn(e,t,n){if(t<Et)throw new Error("invalid exponent, negatives unsupported");if(n<=Et)throw new Error("invalid modulus");if(n===Kt)return Et;let r=Kt;for(;t>Et;)t&Kt&&(r=r*e%n),e=e*e%n,t>>=Kt;return r}function W(e,t,n){let r=e;for(;t-- >Et;)r*=r,r%=n;return r}var Bt=BigInt(0),Re=BigInt(1);function kr(e){return Ln(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})}function In(e){let t=kr(e),{P:n}=t,r=b=>qt(b,n),s=t.montgomeryBits,o=Math.ceil(s/8),i=t.nByteLength,c=t.adjustScalarBytes||(b=>b),f=t.powPminus2||(b=>vn(b,n-BigInt(2),n));function u(b,E,T){let P=r(b*(E-T));return E=r(E-P),T=r(T+P),[E,T]}let l=(t.a-BigInt(2))/BigInt(4);function a(b,E){_e("u",b,Bt,n),_e("scalar",E,Bt,n);let T=E,P=b,L=Re,O=Bt,M=b,A=Re,U=Bt,B;for(let v=BigInt(s-1);v>=Bt;v--){let _=T>>v&Re;U^=_,B=u(U,L,M),L=B[0],M=B[1],B=u(U,O,A),O=B[0],A=B[1],U=_;let I=L+O,S=r(I*I),C=L-O,R=r(C*C),x=S-R,H=M+A,K=M-A,q=r(K*I),$=r(H*C),J=q+$,tt=q-$;M=r(J*J),A=r(P*r(tt*tt)),L=r(S*R),O=r(x*(S+r(l*x)))}B=u(U,L,M),L=B[0],M=B[1],B=u(U,O,A),O=B[0],A=B[1];let N=f(O);return r(L*N)}function d(b){return Un(r(b),o)}function p(b){let E=Te("u coordinate",b,o);return i===32&&(E[31]&=127),Ce(E)}function y(b){let E=Te("scalar",b),T=E.length;if(T!==o&&T!==i){let P=""+o+" or "+i;throw new Error("invalid scalar, expected "+P+" bytes, got "+T)}return Ce(c(E))}function h(b,E){let T=p(E),P=y(b),L=a(T,P);if(L===Bt)throw new Error("invalid private or public key received");return d(L)}let w=d(t.Gu);function m(b){return h(b,w)}return{scalarMult:h,scalarMultBase:m,getSharedSecret:(b,E)=>h(b,E),getPublicKey:b=>m(b),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:w}}var Ne=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");var fs=BigInt(0),Mr=BigInt(1),Sn=BigInt(2),Hr=BigInt(3),Kr=BigInt(5),as=BigInt(8);function qr(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),s=BigInt(80),o=Ne,c=e*e%o*e%o,f=W(c,Sn,o)*c%o,u=W(f,Mr,o)*e%o,l=W(u,Kr,o)*u%o,a=W(l,t,o)*l%o,d=W(a,n,o)*a%o,p=W(d,r,o)*d%o,y=W(p,s,o)*p%o,h=W(y,s,o)*p%o,w=W(h,t,o)*l%o;return{pow_p_5_8:W(w,Sn,o)*e%o,b2:c}}function Pr(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var Pt=In({P:Ne,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let t=Ne,{pow_p_5_8:n,b2:r}=qr(e);return qt(W(n,Hr,t)*r,t)},adjustScalarBytes:Pr,randomBytes:j});var Cn=!1,Fr=!1;async function Tn(e,t){if(Fr)return await t();try{return await e()}catch(n){if(n instanceof ReferenceError||n instanceof DOMException&&n.name==="NotSupportedError")return await t();throw n}}async function Ft(e,t){return await Tn(async()=>{let n=Oe(e)?e:await zr(e),r=await crypto.subtle.importKey("raw",t,{name:"X25519"},Cn,[]);return new Uint8Array(await crypto.subtle.deriveBits({name:"X25519",public:r},n,256))},()=>{if(Oe(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return Pt.scalarMult(e,t)})}async function vt(e){return await Tn(async()=>Ft(e,Pt.GuBytes),()=>{if(Oe(e))throw new Error("CryptoKey provided but X25519 WebCrypto is not supported");return Pt.scalarMultBase(e)})}var Dr=new Uint8Array([48,46,2,1,0,48,5,6,3,43,101,110,4,34,4,32]);async function zr(e){if(e.length!==32)throw new Error("X25519 private key must be 32 bytes");let t=new Uint8Array([...Dr,...e]);return crypto.subtle.importKey("pkcs8",t,{name:"X25519"},Cn,["deriveBits"])}function Oe(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}var Dt=class{s;transcript=[];buf=new Uint8Array(0);constructor(t){this.s=t.getReader()}async readLine(){let t=[];for(;;){let n=this.buf.indexOf(10);if(n>=0)return t.push(this.buf.subarray(0,n)),this.transcript.push(this.buf.subarray(0,n+1)),this.buf=this.buf.subarray(n+1),jr(lt(t));this.buf.length>0&&(t.push(this.buf),this.transcript.push(this.buf));let r=await this.s.read();if(r.done)return this.buf=lt(t),null;this.buf=r.value}}close(){return this.s.releaseLock(),{rest:this.buf,transcript:lt(this.transcript)}}};function jr(e){return e.forEach(t=>{if(t<32||t>126)throw Error("invalid non-ASCII byte in header")}),new TextDecoder().decode(e)}function lt(e){let t=e.reduce((s,o)=>s+o.length,0),n=new Uint8Array(t),r=0;for(let s of e)n.set(s,r),r+=s.length;return n}function At(e,...t){return e.pipeThrough(new TransformStream({start(n){for(let r of t)n.enqueue(r)}}))}function zt(e){return new ReadableStream({start(t){t.enqueue(e),t.close()}})}async function ke(e){if(!(e instanceof ReadableStream))throw new Error("readAll expects a ReadableStream<Uint8Array>");return new Uint8Array(await new Response(e).arrayBuffer())}async function _n(e){if(!(e instanceof ReadableStream))throw new Error("readAllString expects a ReadableStream<Uint8Array>");return await new Response(e).text()}async function Rn(e,t){let n=e.getReader(),r=[],s=0;for(;s<t;){let{done:f,value:u}=await n.read();if(f)throw Error("stream ended before reading "+t+" bytes");r.push(u),s+=u.length}n.releaseLock();let o=lt(r),i=o.subarray(0,t),c=At(e,o.subarray(t));return{data:i,rest:c}}var Q=class{args;body;constructor(t,n){this.args=t,this.body=n}};async function Gr(e){let t=await e.readLine();if(t===null)throw Error("invalid stanza");let n=t.split(" ");if(n.length<2||n.shift()!=="->")return{next:t};for(let o of n)if(o.length===0)throw Error("invalid stanza");let r=[];for(;;){let o=await e.readLine();if(o===null)throw Error("invalid stanza");let i=G.decode(o);if(i.length>48)throw Error("invalid stanza");if(r.push(i),i.length<48)break}let s=lt(r);return{s:new Q(n,s)}}async function Nn(e){let t=new Dt(e),n=await t.readLine();if(n!=="age-encryption.org/v1")throw Error("invalid version "+(n??"line"));let r=[];for(;;){let{s,next:o}=await Gr(t);if(s!==void 0){r.push(s);continue}if(!o.startsWith("--- "))throw Error("invalid header");let i=G.decode(o.slice(4)),{rest:c,transcript:f}=t.close(),u=f.slice(0,f.length-1-o.length+3);return{stanzas:r,headerNoMAC:u,MAC:i,headerSize:f.length,rest:At(e,c)}}}function Me(e){let t=[];t.push(`age-encryption.org/v1
`);for(let n of e){t.push("-> "+n.args.join(" ")+`
`);for(let r=0;r<n.body.length;r+=48){let s=r+48;s>n.body.length&&(s=n.body.length),t.push(G.encode(n.body.subarray(r,s))+`
`)}n.body.length%48===0&&t.push(`
`)}return t.push("---"),new TextEncoder().encode(t.join(""))}function On(e,t){return lt([Me(e),new TextEncoder().encode(" "+G.encode(t)+`
`)])}function kn(){let e=j(32),t=Z.encodeFromBytes("AGE-SECRET-KEY-",e).toUpperCase();return Promise.resolve(t)}async function Mn(e){let t;if(Hn(e))t=e;else{let r=Z.decodeToBytes(e);if(!e.startsWith("AGE-SECRET-KEY-1")||r.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||r.bytes.length!==32)throw Error("invalid identity");t=r.bytes}let n=await vt(t);return Z.encodeFromBytes("age",n)}var Vt=class{recipient;constructor(t){let n=Z.decodeToBytes(t);if(!t.startsWith("age1")||n.prefix.toLowerCase()!=="age"||n.bytes.length!==32)throw Error("invalid recipient");this.recipient=n.bytes}async wrapFileKey(t){let n=j(32),r=await vt(n),s=await Ft(n,this.recipient),o=new Uint8Array(r.length+this.recipient.length);o.set(r),o.set(this.recipient,r.length);let i=st(V,s,o,"age-encryption.org/v1/X25519",32);return[new Q(["X25519",G.encode(r)],Wt(t,i))]}},jt=class{identity;recipient;constructor(t){if(Hn(t)){this.identity=t,this.recipient=vt(t);return}let n=Z.decodeToBytes(t);if(!t.startsWith("AGE-SECRET-KEY-1")||n.prefix.toUpperCase()!=="AGE-SECRET-KEY-"||n.bytes.length!==32)throw Error("invalid identity");this.identity=n.bytes,this.recipient=vt(n.bytes)}async unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!=="X25519")continue;if(n.args.length!==2)throw Error("invalid X25519 stanza");let r=G.decode(n.args[1]);if(r.length!==32)throw Error("invalid X25519 stanza");let s=await Ft(this.identity,r),o=await this.recipient,i=new Uint8Array(r.length+o.length);i.set(r),i.set(o,r.length);let c=st(V,s,i,"age-encryption.org/v1/X25519",32),f=Xt(n.body,c);if(f!==null)return f}return null}},Gt=class{passphrase;logN;constructor(t,n){this.passphrase=t,this.logN=n}wrapFileKey(t){let n=j(16),r="age-encryption.org/v1/scrypt",s=new Uint8Array(r.length+16);s.set(new TextEncoder().encode(r)),s.set(n,r.length);let o=xe(this.passphrase,s,{N:2**this.logN,r:8,p:1,dkLen:32});return[new Q(["scrypt",G.encode(n),this.logN.toString()],Wt(t,o))]}},$t=class{passphrase;constructor(t){this.passphrase=t}unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!=="scrypt")continue;if(t.length!==1)throw Error("scrypt recipient is not the only one in the header");if(n.args.length!==3||!/^[1-9][0-9]*$/.test(n.args[2]))throw Error("invalid scrypt stanza");let r=G.decode(n.args[1]);if(r.length!==16)throw Error("invalid scrypt stanza");let s=Number(n.args[2]);if(s>20)throw Error("scrypt work factor is too high");let o="age-encryption.org/v1/scrypt",i=new Uint8Array(o.length+16);i.set(new TextEncoder().encode(o)),i.set(r,o.length);let c=xe(this.passphrase,i,{N:2**s,r:8,p:1,dkLen:32}),f=Xt(n.body,c);if(f!==null)return f}return null}};function Wt(e,t){let n=new Uint8Array(12);return ft(t,n).encrypt(e)}function Xt(e,t){if(e.length!==32)throw Error("invalid stanza");let n=new Uint8Array(12);try{return ft(t,n).decrypt(e)}catch{return null}}function Hn(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}var dt=16,Ke=64*1024,He=Ke+dt;function Kn(e){let t=new Uint8Array(12),n=()=>{for(let i=t.length-2;i>=0&&(t[i]++,t[i]===0);i--);},r=!0,s=new Uint8Array(He),o=0;return new TransformStream({transform(i,c){for(;i.length>0;){if(o===s.length){let u=ft(e,t).decrypt(s);c.enqueue(u),n(),o=0,r=!1}let f=Math.min(s.length-o,i.length);s.set(i.subarray(0,f),o),o+=f,i=i.subarray(f)}},flush(i){t[11]=1;let c=ft(e,t).decrypt(s.subarray(0,o));if(!r&&c.length===0)throw new Error("final chunk is empty");i.enqueue(c)}})}function qn(e){if(e<dt)throw Error("ciphertext is too small");if(e===dt)return 0;let t=Math.floor(e/He),n=e%He;if(0<n&&n<=dt)throw Error("ciphertext size is invalid");let r=e;return r-=t*dt,r-=n>0?dt:0,r}function Pn(e){let t=new Uint8Array(12),n=()=>{for(let o=t.length-2;o>=0&&(t[o]++,t[o]===0);o--);},r=new Uint8Array(Ke),s=0;return new TransformStream({transform(o,i){for(;o.length>0;){if(s===r.length){let f=ft(e,t).encrypt(r);i.enqueue(f),n(),s=0}let c=Math.min(r.length-s,o.length);r.set(o.subarray(0,c),s),s+=c,o=o.subarray(c)}},flush(o){t[11]=1;let i=ft(e,t).encrypt(r.subarray(0,s));o.enqueue(i)}})}function Fn(e){let t=Math.max(1,Math.ceil(e/Ke));return e+dt*t}var qe={};te(qe,{decode:()=>Wr,encode:()=>$r});function $r(e){let t=[];t.push(`-----BEGIN AGE ENCRYPTED FILE-----
`);for(let n=0;n<e.length;n+=48){let r=n+48;r>e.length&&(r=e.length),t.push(pe.encode(e.subarray(n,r))+`
`)}return t.push(`-----END AGE ENCRYPTED FILE-----
`),t.join("")}function Wr(e){let t=e.trim().replaceAll(`\r
`,`
`).split(`
`);if(t.shift()!=="-----BEGIN AGE ENCRYPTED FILE-----")throw Error("invalid header");if(t.pop()!=="-----END AGE ENCRYPTED FILE-----")throw Error("invalid footer");function n(r,s){return r===t.length-1?s.length>0&&s.length<=64&&s.length%4===0:s.length===64}if(!t.every((r,s)=>n(s,r)))throw Error("invalid line length");if(!t.every(r=>/^[A-Za-z0-9+/=]+$/.test(r)))throw Error("invalid base64");return pe.decode(t.join(""))}var Ve={};te(Ve,{WebAuthnIdentity:()=>ze,WebAuthnRecipient:()=>De,createCredential:()=>Zr});function Yt(e){if(e.length===0)throw Error("cbor: unexpected EOF");let t=e[0]>>5,n=e[0]&31;if(n<=23)return[t,n,e.subarray(1)];if(n===24){if(e.length<2)throw Error("cbor: unexpected EOF");return[t,e[1],e.subarray(2)]}if(n===25){if(e.length<3)throw Error("cbor: unexpected EOF");return[t,e[1]<<8|e[2],e.subarray(3)]}throw Error("cbor: unsupported argument encoding")}function Dn(e){let[t,n,r]=Yt(e);if(t!==0)throw Error("cbor: expected unsigned integer");return[n,r]}function zn(e){let[t,n,r]=Yt(e);if(t!==2)throw Error("cbor: expected byte string");if(n>r.length)throw Error("cbor: unexpected EOF");return[r.subarray(0,n),r.subarray(n)]}function Pe(e){let[t,n,r]=Yt(e);if(t!==3)throw Error("cbor: expected text string");if(n>r.length)throw Error("cbor: unexpected EOF");return[new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0}).decode(r.subarray(0,n)),r.subarray(n)]}function Vn(e){let[t,n,r]=Yt(e);if(t!==4)throw Error("cbor: expected array");let s=r,o=[];for(let i=0;i<n;i++){let c;[c,s]=Pe(s),o.push(c)}return[o,s]}function jn(e){if(e<=23)return new Uint8Array([e]);if(e<=255)return new Uint8Array([24,e]);if(e<=65535)return new Uint8Array([25,e>>8,e&255]);throw Error("cbor: unsigned integer too large")}function Gn(e){if(e.length<=23)return new Uint8Array([64|e.length,...e]);if(e.length<=255)return new Uint8Array([88,e.length,...e]);if(e.length<=65535)return new Uint8Array([89,e.length>>8,e.length&255,...e]);throw Error("cbor: byte string too long")}function Fe(e){let t=new TextEncoder().encode(e);if(t.length<=23)return new Uint8Array([96|t.length,...t]);if(t.length<=255)return new Uint8Array([120,t.length,...t]);if(t.length<=65535)return new Uint8Array([121,t.length>>8,t.length&255,...t]);throw Error("cbor: text string too long")}function $n(e){let t=e.flatMap(n=>[...Fe(n)]);if(e.length<=23)return new Uint8Array([128|e.length,...t]);if(e.length<=255)return new Uint8Array([152,e.length,...t]);if(e.length<=65535)return new Uint8Array([153,e.length>>8,e.length&255,...t]);throw Error("cbor: array too long")}var Yr=[{type:"public-key",alg:-8},{type:"public-key",alg:-7},{type:"public-key",alg:-257}];async function Zr(e){let t=await navigator.credentials.create({publicKey:{rp:{name:"",id:e.rpId},user:{name:e.keyName,id:j(8),displayName:""},pubKeyCredParams:Yr,authenticatorSelection:{requireResidentKey:e.type!=="security-key",residentKey:e.type!=="security-key"?"required":"discouraged",userVerification:"required"},hints:e.type==="security-key"?["security-key"]:[],extensions:{prf:{}},challenge:new Uint8Array([0]).buffer}});if(!t.getClientExtensionResults().prf?.enabled)throw Error("PRF extension not available (need macOS 15+, Chrome 132+)");let n=e.rpId??new URL(window.origin).hostname;return Qr(t,n)}var Wn="AGE-PLUGIN-FIDO2PRF-";function Qr(e,t){let n=e.response,r=jn(1),s=Gn(new Uint8Array(e.rawId)),o=Fe(t),i=$n(n.getTransports()),c=new Uint8Array([...r,...s,...o,...i]);return Z.encode(Wn,Z.toWords(c),!1).toUpperCase()}function Jr(e){let t=Z.decodeToBytes(e);if(!e.startsWith(Wn+"1"))throw Error("invalid identity");let[n,r]=Dn(t.bytes);if(n!==1)throw Error("unsupported identity version");let[s,o]=zn(r),[i,c]=Pe(o),[f]=Vn(c);return[s,i,f]}var Qt="age-encryption.org/fido2prf",Zt=class{credId;transports;rpId;constructor(t){if(t?.identity){let[n,r,s]=Jr(t.identity);this.credId=n,this.transports=s,this.rpId=r}else this.rpId=t?.rpId}async getCredential(t){let r=(await navigator.credentials.get({publicKey:{allowCredentials:this.credId?[{id:this.credId,transports:this.transports,type:"public-key"}]:[],challenge:j(16),extensions:{prf:{eval:to(t)}},userVerification:"required",rpId:this.rpId}})).getClientExtensionResults().prf?.results;if(r===void 0)throw Error("PRF extension not available (need macOS 15+, Chrome 132+)");return r}},De=class extends Zt{async wrapFileKey(t){let n=j(16),r=await this.getCredential(n),s=Xn(r);return[new Q([Qt,G.encode(n)],Wt(t,s))]}},ze=class extends Zt{async unwrapFileKey(t){for(let n of t){if(n.args.length<1||n.args[0]!==Qt)continue;if(n.args.length!==2)throw Error("invalid prf stanza");let r=G.decode(n.args[1]);if(r.length!==16)throw Error("invalid prf stanza");let s=await this.getCredential(r),o=Xn(s),i=Xt(n.body,o);if(i!==null)return i}return null}};function to(e){let t=new TextEncoder().encode(Qt),n=new Uint8Array(t.length+e.length+1);n.set(t,0),n[t.length]=1,n.set(e,t.length+1);let r=new Uint8Array(t.length+e.length+1);return r.set(t,0),r[t.length]=2,r.set(e,t.length+1),{first:n,second:r}}function Xn(e){if(e.second===void 0)throw Error("Missing second PRF result");let t=new Uint8Array(e.first.byteLength+e.second.byteLength);return t.set(new Uint8Array(e.first),0),t.set(new Uint8Array(e.second),e.first.byteLength),oe(V,t,Qt)}var je=class{passphrase=null;scryptWorkFactor=18;recipients=[];setPassphrase(t){if(this.passphrase!==null)throw new Error("can encrypt to at most one passphrase");if(this.recipients.length!==0)throw new Error("can't encrypt to both recipients and passphrases");this.passphrase=t}setScryptWorkFactor(t){this.scryptWorkFactor=t}addRecipient(t){if(this.passphrase!==null)throw new Error("can't encrypt to both recipients and passphrases");typeof t=="string"?this.recipients.push(new Vt(t)):this.recipients.push(t)}async encrypt(t){let n=j(16),r=[],s=this.recipients;this.passphrase!==null&&(s=[new Gt(this.passphrase,this.scryptWorkFactor)]);for(let a of s)r.push(...await a.wrapFileKey(n));let o=st(V,n,void 0,"header",32),i=et(V,o,Me(r)),c=On(r,i),f=j(16),u=st(V,n,f,"payload",32),l=Pn(u);return t instanceof ReadableStream?Object.assign(At(t.pipeThrough(l),c,f),{size:a=>Fn(a)+c.length+f.length}):(typeof t=="string"&&(t=new TextEncoder().encode(t)),await ke(At(zt(t).pipeThrough(l),c,f)))}},Ge=class{identities=[];addPassphrase(t){this.identities.push(new $t(t))}addIdentity(t){typeof t=="string"||no(t)?this.identities.push(new jt(t)):this.identities.push(t)}async decrypt(t,n){let r=t instanceof ReadableStream?t:zt(t),{fileKey:s,headerSize:o,rest:i}=await this.decryptHeaderInternal(r),{data:c,rest:f}=await Rn(i,16),u=st(V,s,c,"payload",32),l=Kn(u),a=f.pipeThrough(l),d=Object.assign(a,{size:p=>qn(p-o-c.length)});return t instanceof ReadableStream?d:n==="text"?await _n(a):await ke(a)}async decryptHeader(t){return(await this.decryptHeaderInternal(zt(t))).fileKey}async decryptHeaderInternal(t){let n=await Nn(t),r=await this.unwrapFileKey(n.stanzas);if(r===null)throw Error("no identity matched any of the file's recipients");let s=st(V,r,void 0,"header",32),o=et(V,s,n.headerNoMAC);if(!eo(n.MAC,o))throw Error("invalid header HMAC");return{fileKey:r,headerSize:n.headerSize,rest:n.rest}}async unwrapFileKey(t){for(let n of this.identities){let r=await n.unwrapFileKey(t);if(r!==null)return r}return null}};function eo(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function no(e){return typeof CryptoKey<"u"&&e instanceof CryptoKey}return tr(ro);})();
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@scure/base/lib/esm/index.js:
  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
